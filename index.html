<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Assinatura Mercado Pago</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9fafb; margin: 0; padding: 0; text-align: center; }
    main { max-width: 600px; margin: 4rem auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    button { background: #4f46e5; color: white; border: none; padding: 1rem 2rem; font-size: 1rem; border-radius: 5px; cursor: pointer; }
    button:hover { background: #4338ca; }
    #resposta { margin-top: 1rem; font-family: monospace; word-break: break-word; font-size: 0.9rem; }
  </style>
</head>
<body>

<main>
  <h1>Assinar Plano com Mercado Pago</h1>
  <p>Clique no botão para criar uma assinatura</p>
  <button onclick="criarAssinatura()">Criar Assinatura</button>
  <p id="resposta"></p>
</main>

<script>
  async function criarAssinatura() {
    const respostaElemento = document.getElementById('resposta');

    try {
      const response = await fetch("https://api.mercadopago.com/preapproval", {
        method: "POST",
        headers: {
          "Authorization": "Bearer APP_USR-5443290444517044-062609-c676718502ddc56c39e7a4a9d121a99f-2513277004", // ⚠️ Substitua por seu token real
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          reason: "Yoga classes",
          external_reference: "YG-1234",
          payer_email: "test_user_75650838@testuser.com",
          auto_recurring: {
            frequency: 1,
            frequency_type: "months",
            end_date: "2025-12-31T23:59:59.000Z",
            transaction_amount: 10,
            currency_id: "BRL"
          },
          back_url: "https://sara-silveira.github.io/pagamento_ok.html",
          status: "pending"
        })
      });

      const data = await response.json();

      if (response.ok) {
        respostaElemento.innerHTML = `✅ Assinatura criada com sucesso!<br>ID: ${data.id}<br>Status: ${data.status}`;
      } else {
        respostaElemento.innerHTML = `❌ Erro: ${data.message || JSON.stringify(data)}`;
      }
    } catch (erro) {
      respostaElemento.innerText = `❌ Erro ao conectar: ${erro.message}`;
    }
  }
</script>

</body>
</html>
